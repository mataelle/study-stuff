Задача 1 (3 балла).
Создайте внешние таблицы по исходным данным для выполнения домашнего задания. В результате будет три таблицы: логи пользователей, данные ip адресов, данные пользователей. Требуется, чтобы сериализация и десериализация данных осуществлялась с использованием регулярного выражения (org.apache.hadoop.hive.contrib.serde2.RegexSerDe). Данные логов необходимо хранить в таблице партицированной по датам – одна партиция на каждый день.
Задача 2 (2 балл).
Напишите запрос sql выбирающий количество хитов для каждого дня.
Задача 3 (3 балла).
Напишите запрос sql выбирающий регионы, в которых количество хитов выше
среднего по всем регионам количества хитов.
Задача 4 (2 балла).
Напишите запрос sql выбирающий количество хитов от мужчин и от женщин по регионам.
Задача 5 (2 баллов).
Представьте, что у Вас очень много данных, и требуется обработать эти данные в кротчайший срок. Напишите запрос sql выбирающий примерное количество запросов от мужчин и от женщин по регионам. Используйте для написания запроса семплирование. Попробуйте различные значения процента семплов от общего объема и сравните точность получаемых оценок в зависимости от процента семплов.Результат отобразите на графике.
Задача 6 (5 баллов).
Создайте новые таблицы для логов пользователей и для данных по ip адресам с хранением таблиц в файлах формата RCFile. Выберете наиболее популярные
страницы для каждого региона. Сравните скорость выполнения запроса для обыкновенных таблиц и для таблиц в файлах формата RCFile.
Задача 7 (3 балла).
Создать пользовательскую функцию «перевертыш». Функция принимает строку и возвращает данную строку записанную в обратном порядке. Подключите данную функцию к hive и выполните выборку «перевертышей» для ip адресов.
Задача 8 (5 баллов).
Представьте ситуацию, что все новостные сайты переехали в домен .com. Вас попросили создать представление, в котором логи пользователей будут указывать не
на старые домены, а на новые. Например, новостная ссылка http://news.rambler.ru/8744806 теперь должна выглядеть в ваших запросах как http://news.rambler.com/8744806. Для создания такого представления используйте стриминг в hive-sql запросе. (Рекомендуется обратить внимание на команды в shell awk и sed).
